<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å…«å­—æ’ç›˜å·¥å…· - é«˜ç²¾åº¦ç®—æ³•</title>
    <style>
      /* =================== ä¸°å¯Œå¤šå½©çš„è®¾è®¡å˜é‡ =================== */
      :root {
        /* ä¸»è‰²è°ƒ - ç¥ç§˜ç´«è‰² */
        --primary-color: #8b5fbf;
        --primary-light: #a855f7;
        --primary-dark: #7c3aed;

        /* è¾…åŠ©è‰²è°ƒ */
        --secondary-color: #06d6a0; /* ç¿¡ç¿ ç»¿ */
        --accent-color: #f72585; /* ç‰çº¢ */
        --warning-color: #fbbf24; /* æ˜é»„ */
        --success-color: #10b981; /* ç»¿è‰² */
        --info-color: #0ea5e9; /* å¤©è“ */
        --orange-color: #f97316; /* æ©™è‰² */
        --pink-color: #ec4899; /* ç²‰çº¢ */
        --indigo-color: #6366f1; /* é è“ */

        /* èƒŒæ™¯æ¸å˜ - æ£‹ç›˜å¼å½©è™¹ */
        --background: linear-gradient(
          45deg,
          #667eea 0%,
          #764ba2 25%,
          #f093fb 50%,
          #f5576c 75%,
          #4facfe 100%
        );

        /* è¡¨é¢é¢œè‰² */
        --surface: rgba(255, 255, 255, 0.95);
        --surface-variant: rgba(248, 250, 252, 0.85);
        --card-surface: rgba(255, 255, 255, 0.98);
        --surface-tint: rgba(139, 95, 191, 0.05);

        /* æ–‡å­—é¢œè‰² */
        --on-surface: #1e293b;
        --on-surface-variant: #64748b;
        --on-primary: #ffffff;

        /* è¾¹æ¡†å’Œé˜´å½± */
        --border: rgba(203, 213, 225, 0.4);
        --border-focus: var(--primary-color);
        --border-colorful: linear-gradient(45deg, #f093fb, #f5576c, #4facfe);

        /* é˜´å½±æ•ˆæœ */
        --shadow:
          0 4px 20px rgba(139, 95, 191, 0.15), 0 2px 8px rgba(0, 0, 0, 0.05);
        --shadow-elevated:
          0 8px 32px rgba(139, 95, 191, 0.2), 0 4px 16px rgba(0, 0, 0, 0.1);
        --shadow-glow: 0 0 40px rgba(139, 95, 191, 0.4);
        --shadow-colorful: 0 8px 32px rgba(247, 37, 133, 0.3);

        /* åœ†è§’ */
        --radius: 16px;
        --radius-lg: 24px;
        --radius-xl: 32px;

        /* è¿‡æ¸¡æ•ˆæœ */
        --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);

        /* å¤šå½©æ¸å˜ */
        --gradient-primary: linear-gradient(
          135deg,
          #8b5fbf 0%,
          #a855f7 30%,
          #ec4899 70%,
          #f97316 100%
        );
        --gradient-secondary: linear-gradient(
          135deg,
          #06d6a0 0%,
          #0ea5e9 50%,
          #6366f1 100%
        );
        --gradient-warm: linear-gradient(
          135deg,
          #f093fb 0%,
          #f5576c 50%,
          #fbbf24 100%
        );
        --gradient-cool: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --gradient-card: linear-gradient(
          145deg,
          rgba(255, 255, 255, 0.98) 0%,
          rgba(255, 255, 255, 0.9) 100%
        );
        --gradient-glass: linear-gradient(
          145deg,
          rgba(255, 255, 255, 0.3) 0%,
          rgba(255, 255, 255, 0.1) 100%
        );

        /* ç»ç’ƒæ•ˆæœ */
        --glass-bg: rgba(255, 255, 255, 0.2);
        --glass-border: rgba(255, 255, 255, 0.3);
        --glass-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
      }

      /* =================== åŸºç¡€æ ·å¼ =================== */
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        padding: 0;
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC",
          "Hiragino Sans GB", "Microsoft YaHei", "å¾®è½¯é›…é»‘", Arial, sans-serif;
        background: var(--background);
        color: var(--on-surface);
        line-height: 1.6;
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background:
          radial-gradient(
            circle at 20% 50%,
            rgba(120, 119, 198, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(255, 119, 198, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 80%,
            rgba(120, 219, 255, 0.1) 0%,
            transparent 50%
          );
        z-index: -1;
      }

      body::after {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background:
          radial-gradient(
            circle at 20% 30%,
            rgba(139, 95, 191, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(247, 37, 133, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 70%,
            rgba(6, 214, 160, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 1px 1px,
            rgba(255, 255, 255, 0.2) 1px,
            transparent 0
          );
        background-size:
          100% 100%,
          100% 100%,
          100% 100%,
          40px 40px;
        z-index: -1;
        opacity: 0.6;
        animation: floatBackground 20s ease-in-out infinite;
      }

      @keyframes floatBackground {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        50% {
          transform: translateY(-10px) rotate(1deg);
        }
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* =================== ç²¾ç¾æ ‡é¢˜åŒºåŸŸ =================== */
      .header {
        text-align: center;
        margin-bottom: 60px;
        background: var(--gradient-card);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 2px solid var(--glass-border);
        padding: 80px 40px;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-elevated), var(--shadow-glow);
        position: relative;
        overflow: hidden;
        transform: translateY(0);
        animation: headerFloat 6s ease-in-out infinite;
      }

      @keyframes headerFloat {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-5px);
        }
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--gradient-primary);
        opacity: 0.05;
        z-index: -1;
        animation: gradientShift 8s ease-in-out infinite;
      }

      @keyframes gradientShift {
        0%,
        100% {
          opacity: 0.05;
          transform: rotate(0deg);
        }
        50% {
          opacity: 0.1;
          transform: rotate(2deg);
        }
      }

      .header::after {
        content: "âœ¨";
        position: absolute;
        top: 20px;
        right: 30px;
        font-size: 2rem;
        animation: sparkle 3s ease-in-out infinite;
      }

      @keyframes sparkle {
        0%,
        100% {
          transform: rotate(0deg) scale(1);
          opacity: 0.7;
        }
        50% {
          transform: rotate(180deg) scale(1.2);
          opacity: 1;
        }
      }

      .header h1 {
        font-size: 3.5rem;
        margin: 0 0 20px 0;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        letter-spacing: -0.03em;
        text-shadow: 0 4px 8px rgba(139, 95, 191, 0.3);
        position: relative;
      }

      .header h1::before {
        content: "å¤ªæ";
        position: absolute;
        top: -15px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.3em;
        color: var(--accent-color);
        opacity: 0.7;
      }

      .header .subtitle {
        color: var(--on-surface-variant);
        font-size: 1.3rem;
        margin: 0 0 40px 0;
        font-weight: 500;
        opacity: 0.85;
        background: var(--gradient-secondary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .features {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .feature-tag {
        background: var(--gradient-glass);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border: 2px solid var(--glass-border);
        color: var(--primary-color);
        padding: 10px 20px;
        border-radius: 30px;
        font-size: 0.95rem;
        font-weight: 700;
        transition: var(--transition-bounce);
        position: relative;
        overflow: hidden;
      }

      .feature-tag:nth-child(1) {
        border-color: var(--accent-color);
        color: var(--accent-color);
      }
      .feature-tag:nth-child(2) {
        border-color: var(--secondary-color);
        color: var(--secondary-color);
      }
      .feature-tag:nth-child(3) {
        border-color: var(--info-color);
        color: var(--info-color);
      }
      .feature-tag:nth-child(4) {
        border-color: var(--orange-color);
        color: var(--orange-color);
      }
      .feature-tag:nth-child(5) {
        border-color: var(--warning-color);
        color: var(--warning-color);
      }

      .feature-tag::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        transition: var(--transition);
      }

      .feature-tag:hover {
        transform: translateY(-4px) scale(1.05);
        box-shadow: var(--shadow-colorful);
      }

      .feature-tag:hover::before {
        left: 100%;
      }

      .feature-tag:nth-child(1):hover {
        background: var(--accent-color);
        color: white;
      }
      .feature-tag:nth-child(2):hover {
        background: var(--secondary-color);
        color: white;
      }
      .feature-tag:nth-child(3):hover {
        background: var(--info-color);
        color: white;
      }
      .feature-tag:nth-child(4):hover {
        background: var(--orange-color);
        color: white;
      }
      .feature-tag:nth-child(5):hover {
        background: var(--warning-color);
        color: white;
      }

      /* =================== ç²¾ç¾è¾“å…¥è¡¨å• =================== */
      .input-section {
        background: var(--gradient-card);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 2px solid var(--glass-border);
        padding: 45px;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-elevated), var(--glass-shadow);
        margin-bottom: 50px;
        position: relative;
        overflow: hidden;
      }

      .input-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: var(--gradient-primary);
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        animation: gradientFlow 3s ease-in-out infinite;
      }

      @keyframes gradientFlow {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      .input-section::after {
        content: "é˜´é˜³";
        position: absolute;
        top: 20px;
        right: 25px;
        font-size: 1.5rem;
        color: var(--primary-color);
        opacity: 0.4;
        animation: rotate 10s linear infinite;
      }

      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 700;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin: 0 0 30px 0;
        padding-bottom: 15px;
        border-bottom: 3px solid transparent;
        background-image:
          linear-gradient(var(--surface), var(--surface)),
          var(--gradient-primary);
        background-origin: border-box;
        background-clip: padding-box, border-box;
        position: relative;
      }

      .section-title::before {
        content: "âœ¨";
        margin-right: 10px;
        color: var(--accent-color);
      }

      .input-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .form-row {
        display: flex;
        gap: 15px;
        align-items: end;
      }

      .form-field {
        flex: 1;
      }

      .form-field label {
        display: block;
        font-weight: 500;
        margin-bottom: 6px;
        color: var(--on-surface);
        font-size: 0.9rem;
      }

      .form-field input,
      .form-field select {
        width: 100%;
        padding: 14px 18px;
        border: 2px solid var(--border);
        border-radius: var(--radius);
        font-size: 1rem;
        background: var(--surface);
        color: var(--on-surface);
        transition: var(--transition);
        position: relative;
      }

      .form-field input:focus,
      .form-field select:focus {
        outline: none;
        border: 2px solid transparent;
        background:
          linear-gradient(var(--surface), var(--surface)) padding-box,
          var(--gradient-primary) border-box;
        box-shadow:
          0 0 0 4px rgba(139, 95, 191, 0.2),
          var(--shadow);
        transform: translateY(-2px);
      }

      .form-field input:hover,
      .form-field select:hover {
        border-color: var(--primary-color);
        box-shadow: 0 2px 8px rgba(139, 95, 191, 0.1);
      }

      /* =================== é€‰é¡¹å¼€å…³ =================== */
      .options-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .checkbox-field {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 16px;
        background: var(--surface-variant);
        border-radius: var(--radius);
        transition: var(--transition);
        cursor: pointer;
      }

      .checkbox-field:hover {
        background: #e8f0fe;
      }

      .checkbox-field input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: var(--primary-color);
      }

      .checkbox-field label {
        margin: 0;
        cursor: pointer;
        font-size: 0.9rem;
      }

      /* =================== ç‚«å½©æŒ‰é’® =================== */
      .button-group {
        text-align: center;
        margin-top: 50px;
        display: flex;
        gap: 25px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        padding: 18px 36px;
        font-size: 1.15rem;
        font-weight: 700;
        border: none;
        border-radius: var(--radius-xl);
        cursor: pointer;
        transition: var(--transition-bounce);
        text-decoration: none;
        background: var(--gradient-primary);
        color: white;
        box-shadow:
          var(--shadow-elevated),
          0 0 30px rgba(139, 95, 191, 0.4);
        min-width: 180px;
        position: relative;
        overflow: hidden;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: var(--transition);
      }

      .btn::after {
        content: "âœ¨";
        position: absolute;
        top: 50%;
        right: 15px;
        transform: translateY(-50%);
        opacity: 0;
        transition: var(--transition);
      }

      .btn:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow:
          var(--shadow-elevated),
          0 15px 40px rgba(139, 95, 191, 0.6),
          0 0 60px rgba(247, 37, 133, 0.4);
        filter: brightness(1.15) saturate(1.2);
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn:hover::after {
        opacity: 1;
        right: 12px;
      }

      .btn:active {
        transform: translateY(-2px) scale(1.02);
      }

      .btn-secondary {
        background: var(--gradient-glass);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        color: var(--primary-color);
        border: 3px solid var(--glass-border);
        box-shadow: var(--glass-shadow);
      }

      .btn-secondary:hover {
        background: var(--gradient-secondary);
        border-color: var(--secondary-color);
        color: white;
        box-shadow: 0 15px 40px rgba(6, 214, 160, 0.4);
      }

      /* =================== ç‚«å½©ç»“æœæ˜¾ç¤º =================== */
      .result-section {
        background: var(--gradient-card);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 3px solid var(--glass-border);
        padding: 50px;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-elevated), var(--glass-shadow);
        margin-bottom: 50px;
        display: none;
        position: relative;
        overflow: hidden;
      }

      .result-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 8px;
        background: var(--gradient-primary);
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        animation: gradientFlow 4s ease-in-out infinite;
      }

      .result-section::after {
        content: "å…«å¦";
        position: absolute;
        top: 20px;
        right: 25px;
        font-size: 2rem;
        color: var(--primary-color);
        opacity: 0.3;
        animation: rotate 15s linear infinite;
      }

      .result-section.show {
        display: block;
        animation: slideInUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(50px) scale(0.9);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      /* ç²¾ç¾å…«å­—è¡¨æ ¼ */
      .bazi-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin: 40px 0;
        background: var(--gradient-card);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 3px solid var(--glass-border);
        border-radius: var(--radius-xl);
        overflow: hidden;
        box-shadow: var(--shadow-elevated), var(--glass-shadow);
        position: relative;
      }

      .bazi-table::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: var(--gradient-primary);
        z-index: 1;
      }

      .bazi-table th {
        background: var(--gradient-primary);
        color: white;
        padding: 20px 18px;
        font-weight: 700;
        text-align: center;
        font-size: 1.1rem;
        letter-spacing: 1px;
        text-transform: uppercase;
        position: relative;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .bazi-table th:nth-child(1)::after {
        content: "ğŸ•°ï¸";
        position: absolute;
        top: 5px;
        right: 8px;
      }
      .bazi-table th:nth-child(2)::after {
        content: "âœ¨";
        position: absolute;
        top: 5px;
        right: 8px;
      }
      .bazi-table th:nth-child(3)::after {
        content: "ğŸŒŒ";
        position: absolute;
        top: 5px;
        right: 8px;
      }
      .bazi-table th:nth-child(4)::after {
        content: "ğŸŒ¿";
        position: absolute;
        top: 5px;
        right: 8px;
      }
      .bazi-table th:nth-child(5)::after {
        content: "â˜€ï¸";
        position: absolute;
        top: 5px;
        right: 8px;
      }
      .bazi-table th:nth-child(6)::after {
        content: "ğŸµ";
        position: absolute;
        top: 5px;
        right: 8px;
      }

      .bazi-table td {
        padding: 20px 18px;
        text-align: center;
        border-bottom: 2px solid rgba(203, 213, 225, 0.2);
        transition: var(--transition);
        font-size: 1.05rem;
        font-weight: 500;
        position: relative;
      }

      .bazi-table tbody tr:nth-child(1) td:first-child {
        color: var(--accent-color);
        font-weight: 700;
      }
      .bazi-table tbody tr:nth-child(2) td:first-child {
        color: var(--secondary-color);
        font-weight: 700;
      }
      .bazi-table tbody tr:nth-child(3) td:first-child {
        color: var(--info-color);
        font-weight: 700;
      }
      .bazi-table tbody tr:nth-child(4) td:first-child {
        color: var(--orange-color);
        font-weight: 700;
      }

      .bazi-table tbody tr:nth-child(1) td:nth-child(2) {
        background: var(--gradient-warm);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        font-size: 1.3rem;
      }
      .bazi-table tbody tr:nth-child(2) td:nth-child(2) {
        background: var(--gradient-secondary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        font-size: 1.3rem;
      }
      .bazi-table tbody tr:nth-child(3) td:nth-child(2) {
        background: var(--gradient-cool);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        font-size: 1.3rem;
      }
      .bazi-table tbody tr:nth-child(4) td:nth-child(2) {
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        font-size: 1.3rem;
      }

      .bazi-table tbody tr:last-child td {
        border-bottom: none;
      }

      .bazi-table tbody tr:hover {
        background: linear-gradient(
          90deg,
          rgba(139, 95, 191, 0.05),
          rgba(247, 37, 133, 0.05)
        );
        transform: scale(1.005);
      }

      .bazi-table tbody tr:hover td {
        box-shadow: inset 0 0 0 2px rgba(139, 95, 191, 0.3);
        color: var(--on-surface);
      }

      /* å¤šå½©å…«å­—å¡ç‰‡ */
      .bazi-cards {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 30px;
        margin: 40px 0;
      }

      .pillar-card {
        background: var(--gradient-card);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 3px solid var(--glass-border);
        border-radius: var(--radius-xl);
        padding: 30px 25px;
        text-align: center;
        transition: var(--transition-bounce);
        position: relative;
        overflow: hidden;
        transform: translateZ(0);
      }

      .pillar-card:nth-child(1) {
        border-color: var(--accent-color);
        background: linear-gradient(
          145deg,
          rgba(247, 37, 133, 0.1),
          rgba(255, 255, 255, 0.95)
        );
      }
      .pillar-card:nth-child(2) {
        border-color: var(--secondary-color);
        background: linear-gradient(
          145deg,
          rgba(6, 214, 160, 0.1),
          rgba(255, 255, 255, 0.95)
        );
      }
      .pillar-card:nth-child(3) {
        border-color: var(--info-color);
        background: linear-gradient(
          145deg,
          rgba(14, 165, 233, 0.1),
          rgba(255, 255, 255, 0.95)
        );
      }
      .pillar-card:nth-child(4) {
        border-color: var(--orange-color);
        background: linear-gradient(
          145deg,
          rgba(249, 115, 22, 0.1),
          rgba(255, 255, 255, 0.95)
        );
      }

      .pillar-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        transform: scaleX(0);
        transition: var(--transition);
        transform-origin: left;
      }

      .pillar-card:nth-child(1)::before {
        background: var(--gradient-warm);
      }
      .pillar-card:nth-child(2)::before {
        background: var(--gradient-secondary);
      }
      .pillar-card:nth-child(3)::before {
        background: var(--gradient-cool);
      }
      .pillar-card:nth-child(4)::before {
        background: var(--gradient-primary);
      }

      .pillar-card::after {
        content: "";
        position: absolute;
        top: 15px;
        right: 15px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        transition: var(--transition);
      }

      .pillar-card:nth-child(1)::after {
        background: var(--accent-color);
      }
      .pillar-card:nth-child(2)::after {
        background: var(--secondary-color);
      }
      .pillar-card:nth-child(3)::after {
        background: var(--info-color);
      }
      .pillar-card:nth-child(4)::after {
        background: var(--orange-color);
      }

      .pillar-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: var(--shadow-elevated), var(--shadow-colorful);
      }

      .pillar-card:hover::before {
        transform: scaleX(1);
      }

      .pillar-card:hover::after {
        transform: scale(1.5);
        box-shadow: 0 0 20px currentColor;
      }

      .pillar-card .title {
        font-size: 1.1rem;
        color: var(--on-surface);
        margin-bottom: 20px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
        position: relative;
      }

      .pillar-card:nth-child(1) .title {
        color: var(--accent-color);
      }
      .pillar-card:nth-child(2) .title {
        color: var(--secondary-color);
      }
      .pillar-card:nth-child(3) .title {
        color: var(--info-color);
      }
      .pillar-card:nth-child(4) .title {
        color: var(--orange-color);
      }

      .pillar-card .ganZhi {
        font-size: 2.8rem;
        font-weight: 900;
        margin: 20px 0;
        line-height: 1;
        position: relative;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .pillar-card:nth-child(1) .ganZhi {
        background: var(--gradient-warm);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .pillar-card:nth-child(2) .ganZhi {
        background: var(--gradient-secondary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .pillar-card:nth-child(3) .ganZhi {
        background: var(--gradient-cool);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .pillar-card:nth-child(4) .ganZhi {
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .pillar-card .details {
        font-size: 1rem;
        color: var(--on-surface-variant);
        line-height: 1.6;
        opacity: 0.85;
        font-weight: 500;
      }

      /* =================== ç²¾ç¾è¯¦ç»†ä¿¡æ¯ =================== */
      .info-panel {
        background: var(--gradient-glass);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border: 2px solid var(--glass-border);
        border-radius: var(--radius-xl);
        padding: 30px;
        margin-top: 30px;
        position: relative;
        overflow: hidden;
        box-shadow: var(--glass-shadow);
      }

      .info-panel::before {
        content: "âš™ï¸";
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 1.5rem;
        opacity: 0.3;
        animation: rotate 8s linear infinite;
      }

      .info-panel h3 {
        margin-top: 0;
        background: var(--gradient-secondary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 25px;
      }

      .info-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 2px solid rgba(139, 95, 191, 0.1);
        transition: var(--transition);
      }

      .info-row:hover {
        background: rgba(139, 95, 191, 0.05);
        border-radius: var(--radius);
        padding: 12px 15px;
        margin: 0 -15px;
      }

      .info-row:last-child {
        border-bottom: none;
      }

      .info-label {
        font-weight: 600;
        color: var(--on-surface);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .info-label::before {
        content: "â€¢";
        color: var(--primary-color);
        font-weight: 900;
      }

      .info-value {
        color: var(--primary-color);
        font-weight: 500;
        font-family: monospace;
        background: rgba(139, 95, 191, 0.1);
        padding: 4px 8px;
        border-radius: var(--radius);
        font-size: 0.9rem;
      }

      /* =================== ç‚«å½©è­¦å‘Šæç¤º =================== */
      .alert {
        padding: 20px 25px;
        border-radius: var(--radius-lg);
        margin: 20px 0;
        border: none;
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: var(--shadow);
        font-weight: 500;
      }

      .alert::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 6px;
      }

      .alert-info {
        background: linear-gradient(
          135deg,
          rgba(14, 165, 233, 0.1),
          rgba(255, 255, 255, 0.9)
        );
        color: var(--info-color);
      }
      .alert-info::before {
        background: var(--gradient-cool);
      }

      .alert-warning {
        background: linear-gradient(
          135deg,
          rgba(251, 191, 36, 0.1),
          rgba(255, 255, 255, 0.9)
        );
        color: var(--warning-color);
      }
      .alert-warning::before {
        background: linear-gradient(
          135deg,
          var(--warning-color),
          var(--orange-color)
        );
      }

      .alert-success {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1),
          rgba(255, 255, 255, 0.9)
        );
        color: var(--success-color);
      }
      .alert-success::before {
        background: var(--gradient-secondary);
      }

      /* =================== å“åº”å¼å¸ƒå±€ =================== */
      /* =================== åŠ¨æ€èƒŒæ™¯å…ƒç´  =================== */
      .container {
        position: relative;
      }

      .container::before {
        content: "å¤ª";
        position: absolute;
        top: 15%;
        left: 5%;
        font-size: 8rem;
        color: rgba(139, 95, 191, 0.03);
        z-index: -1;
        animation: float 12s ease-in-out infinite;
      }

      .container::after {
        content: "æ";
        position: absolute;
        bottom: 15%;
        right: 5%;
        font-size: 8rem;
        color: rgba(247, 37, 133, 0.03);
        z-index: -1;
        animation: float 12s ease-in-out infinite reverse;
      }

      @media (max-width: 1024px) {
        .container {
          padding: 20px;
        }

        .input-section,
        .result-section {
          padding: 30px;
        }

        .header {
          padding: 50px 25px;
        }

        .container::before,
        .container::after {
          font-size: 6rem;
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 15px;
        }

        .header {
          padding: 40px 20px;
          margin-bottom: 35px;
        }

        .header h1 {
          font-size: 2.5rem;
        }

        .header .subtitle {
          font-size: 1.1rem;
        }

        .input-section,
        .result-section {
          padding: 30px;
          margin-bottom: 35px;
        }

        .input-grid {
          grid-template-columns: 1fr;
          gap: 30px;
        }

        .form-row {
          flex-direction: column;
          gap: 15px;
        }

        .bazi-cards {
          grid-template-columns: repeat(2, 1fr);
          gap: 20px;
          margin: 25px 0;
        }

        .pillar-card {
          padding: 25px 20px;
        }

        .pillar-card .ganZhi {
          font-size: 2.2rem;
        }

        .options-group {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .features {
          flex-direction: column;
          align-items: center;
          gap: 15px;
        }

        .button-group {
          flex-direction: column;
          align-items: center;
          gap: 20px;
        }

        .btn {
          width: 100%;
          max-width: 350px;
          padding: 20px 40px;
          font-size: 1.1rem;
        }

        .bazi-table {
          font-size: 0.95rem;
        }

        .bazi-table th,
        .bazi-table td {
          padding: 15px 10px;
          font-size: 0.95rem;
        }

        .container::before,
        .container::after {
          font-size: 5rem;
          opacity: 0.02;
        }

        .info-panel {
          padding: 25px;
        }

        .info-row {
          flex-direction: column;
          align-items: flex-start;
          gap: 5px;
        }
      }

      @media (max-width: 480px) {
        .container {
          padding: 10px;
        }

        .header {
          padding: 30px 15px;
          margin-bottom: 25px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .header h1::before {
          font-size: 0.4em;
          top: -10px;
        }

        .header .subtitle {
          font-size: 1rem;
          margin-bottom: 25px;
        }

        .input-section,
        .result-section {
          padding: 20px;
          margin-bottom: 25px;
        }

        .bazi-cards {
          grid-template-columns: 1fr;
          gap: 20px;
          margin: 20px 0;
        }

        .pillar-card {
          padding: 25px 20px;
        }

        .pillar-card .ganZhi {
          font-size: 2rem;
        }

        .pillar-card .title {
          font-size: 1rem;
          margin-bottom: 15px;
        }

        .pillar-card .details {
          font-size: 0.9rem;
        }

        .feature-tag {
          padding: 8px 16px;
          font-size: 0.85rem;
          width: 100%;
          text-align: center;
        }

        .features {
          gap: 10px;
        }

        .section-title {
          font-size: 1.3rem;
        }

        .btn {
          padding: 18px 30px;
          font-size: 1rem;
          min-width: 100%;
        }

        .bazi-table {
          font-size: 0.85rem;
        }

        .bazi-table th {
          padding: 12px 8px;
          font-size: 0.85rem;
        }

        .bazi-table td {
          padding: 12px 8px;
          font-size: 0.85rem;
        }

        .bazi-table tbody tr:nth-child(1) td:nth-child(2),
        .bazi-table tbody tr:nth-child(2) td:nth-child(2),
        .bazi-table tbody tr:nth-child(3) td:nth-child(2),
        .bazi-table tbody tr:nth-child(4) td:nth-child(2) {
          font-size: 1.1rem;
        }

        .info-panel {
          padding: 20px;
        }

        .info-panel h3 {
          font-size: 1.1rem;
        }

        .info-row {
          flex-direction: column;
          gap: 6px;
          align-items: flex-start;
          padding: 10px 0;
        }

        .info-value {
          font-size: 0.85rem;
          width: 100%;
          text-align: left;
        }

        .container::before,
        .container::after {
          display: none;
        }

        .alert {
          padding: 15px 20px;
          margin: 15px 0;
          font-size: 0.9rem;
        }

        .form-field input,
        .form-field select {
          padding: 16px 20px;
          font-size: 1rem;
        }
      }

      /* =================== ä¸°å¯ŒåŠ¨ç”»æ•ˆæœ =================== */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes rainbow {
        0% {
          filter: hue-rotate(0deg);
        }
        100% {
          filter: hue-rotate(360deg);
        }
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.8;
        }
        50% {
          transform: scale(1.05);
          opacity: 1;
        }
      }

      @keyframes shimmer {
        0% {
          background-position: -200px 0;
        }
        100% {
          background-position: 200px 0;
        }
      }

      .fade-in {
        animation: fadeInUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }

      .slide-in-left {
        animation: slideInLeft 0.6s ease-out;
      }

      .slide-in-right {
        animation: slideInRight 0.6s ease-out;
      }

      .scale-in {
        animation: scaleIn 0.5s ease-out;
      }

      /* =================== ç²¾ç¾åŠ è½½çŠ¶æ€ =================== */
      .loading {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 60px;
        flex-direction: column;
        gap: 20px;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(139, 95, 191, 0.2);
        border-top: 5px solid var(--primary-color);
        border-right: 5px solid var(--accent-color);
        border-radius: 50%;
        animation:
          spin 1.5s linear infinite,
          rainbow 3s ease-in-out infinite;
        box-shadow: 0 0 20px rgba(139, 95, 191, 0.3);
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        color: var(--primary-color);
        font-weight: 600;
        font-size: 1.1rem;
        animation: pulse 2s ease-in-out infinite;
      }

      /* =================== æ‚¬æµ®å…ƒç´  =================== */
      .floating-element {
        position: absolute;
        pointer-events: none;
        opacity: 0.1;
        font-size: 2rem;
        animation: float 8s ease-in-out infinite;
        z-index: -1;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        25% {
          transform: translateY(-20px) rotate(90deg);
        }
        50% {
          transform: translateY(-10px) rotate(180deg);
        }
        75% {
          transform: translateY(-30px) rotate(270deg);
        }
      }

      .floating-element:nth-child(1) {
        top: 10%;
        left: 5%;
        animation-delay: 0s;
      }
      .floating-element:nth-child(2) {
        top: 20%;
        right: 10%;
        animation-delay: 2s;
      }
      .floating-element:nth-child(3) {
        bottom: 30%;
        left: 8%;
        animation-delay: 4s;
      }
      .floating-element:nth-child(4) {
        bottom: 10%;
        right: 5%;
        animation-delay: 6s;
      }

      /* ç§»åŠ¨è®¾å¤‡éšè—æ‚¬æµ®å…ƒç´  */
      @media (max-width: 768px) {
        .floating-element {
          display: none;
        }
      }

      /* =================== é—ªçƒæ•ˆæœ =================== */
      .shimmer {
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        background-size: 200px 100%;
        animation: shimmer 2s infinite;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- é¡µé¢æ ‡é¢˜ -->
      <div class="header">
        <h1>å…«å­—æ’ç›˜å·¥å…·</h1>
        <p class="subtitle">é«˜ç²¾åº¦ç®—æ³• Â· ä¸“ä¸šæ’ç›˜ Â· è¯¦ç»†åˆ†æ</p>
        <div class="features">
          <span class="feature-tag">âœ¨ çœŸå¤ªé˜³æ—¶æ ¡æ­£</span>
          <span class="feature-tag">ğŸŒ… èŠ‚æ°”è‡ªåŠ¨åˆ¤æ–­</span>
          <span class="feature-tag">ğŸŒŒ åç¥åˆ†æ</span>
          <span class="feature-tag">ğŸŒ¿ äº”è¡Œå½’å±</span>
          <span class="feature-tag">ğŸŒ™ å­æ—¶äº¤æ—¥</span>
        </div>
      </div>

      <!-- è¾“å…¥è¡¨å• -->
      <div class="input-section">
        <h2 class="section-title">åŸºæœ¬ä¿¡æ¯</h2>
        <div class="input-grid">
          <div class="input-group">
            <h3>å‡ºç”Ÿæ—¶é—´</h3>
            <div class="form-row">
              <div class="form-field">
                <label for="year">å¹´ä»½</label>
                <input
                  type="number"
                  id="year"
                  value="1990"
                  min="1900"
                  max="2100"
                />
              </div>
              <div class="form-field">
                <label for="month">æœˆä»½</label>
                <select id="month">
                  <option value="1">1æœˆ</option>
                  <option value="2">2æœˆ</option>
                  <option value="3" selected>3æœˆ</option>
                  <option value="4">4æœˆ</option>
                  <option value="5">5æœˆ</option>
                  <option value="6">6æœˆ</option>
                  <option value="7">7æœˆ</option>
                  <option value="8">8æœˆ</option>
                  <option value="9">9æœˆ</option>
                  <option value="10">10æœˆ</option>
                  <option value="11">11æœˆ</option>
                  <option value="12">12æœˆ</option>
                </select>
              </div>
              <div class="form-field">
                <label for="day">æ—¥æœŸ</label>
                <input type="number" id="day" value="21" min="1" max="31" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label for="hour">æ—¶</label>
                <input type="number" id="hour" value="10" min="0" max="23" />
              </div>
              <div class="form-field">
                <label for="minute">åˆ†</label>
                <input type="number" id="minute" value="30" min="0" max="59" />
              </div>
              <div class="form-field">
                <label for="second">ç§’</label>
                <input type="number" id="second" value="0" min="0" max="59" />
              </div>
            </div>
          </div>

          <div class="input-group">
            <h3>åœ°ç†ä½ç½®</h3>
            <div class="form-row">
              <div class="form-field">
                <label for="timezone">æ—¶åŒº</label>
                <select id="timezone">
                  <option value="+08:00" selected>UTC+8:00 (åŒ—äº¬æ—¶é—´)</option>
                  <option value="+09:00">UTC+9:00 (æ—¥æœ¬æ—¶é—´)</option>
                  <option value="+07:00">UTC+7:00 (æ³°å›½æ—¶é—´)</option>
                  <option value="+05:30">UTC+5:30 (å°åº¦æ—¶é—´)</option>
                  <option value="Â±00:00">UTCÂ±0:00 (æ ¼æ—å¨æ²»)</option>
                  <option value="-05:00">UTC-5:00 (ç¾ä¸œæ—¶é—´)</option>
                  <option value="-08:00">UTC-8:00 (ç¾è¥¿æ—¶é—´)</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label for="longitude">ç»åº¦ (ä¸œç»ä¸ºæ­£)</label>
                <input
                  type="number"
                  id="longitude"
                  value="116.40"
                  step="0.01"
                  min="-180"
                  max="180"
                />
              </div>
              <div class="form-field">
                <label for="latitude">çº¬åº¦ (åŒ—çº¬ä¸ºæ­£)</label>
                <input
                  type="number"
                  id="latitude"
                  value="39.90"
                  step="0.01"
                  min="-90"
                  max="90"
                />
              </div>
            </div>
          </div>
        </div>

        <h3>è®¡ç®—é€‰é¡¹</h3>
        <div class="options-group">
          <div class="checkbox-field">
            <input type="checkbox" id="useSolarTime" />
            <label for="useSolarTime">ä½¿ç”¨çœŸå¤ªé˜³æ—¶ (ä»…å½±å“æ—¶æŸ±)</label>
          </div>
          <div class="checkbox-field">
            <input type="checkbox" id="useZi23" checked />
            <label for="useZi23">å­åˆäº¤æ—¥ (23:00äº¤æ—¥)</label>
          </div>
          <div class="checkbox-field">
            <input type="checkbox" id="useSolarBoundary" />
            <label for="useSolarBoundary">æ—¥ç•Œä½¿ç”¨çœŸå¤ªé˜³æ—¶ (å®éªŒåŠŸèƒ½)</label>
          </div>
          <div class="checkbox-field">
            <input type="checkbox" id="showDetails" checked />
            <label for="showDetails">æ˜¾ç¤ºè®¡ç®—è¯¦æƒ…</label>
          </div>
        </div>

        <div class="button-group">
          <button class="btn" id="calculateBtn">
            <span>å¼€å§‹æ’ç›˜</span>
          </button>
          <button class="btn btn-secondary" id="resetBtn">
            <span>é‡ç½®</span>
          </button>
        </div>
      </div>

      <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
      <div class="result-section" id="resultSection">
        <h2 class="section-title">æ’ç›˜ç»“æœ</h2>

        <!-- å…«å­—å¡ç‰‡æ˜¾ç¤º -->
        <div class="bazi-cards" id="baziCards">
          <div class="pillar-card">
            <div class="title">å¹´æŸ±</div>
            <div class="ganZhi" id="yearPillar">--</div>
            <div class="details" id="yearDetails">--</div>
          </div>
          <div class="pillar-card">
            <div class="title">æœˆæŸ±</div>
            <div class="ganZhi" id="monthPillar">--</div>
            <div class="details" id="monthDetails">--</div>
          </div>
          <div class="pillar-card">
            <div class="title">æ—¥æŸ±</div>
            <div class="ganZhi" id="dayPillar">--</div>
            <div class="details" id="dayDetails">æ—¥ä¸»</div>
          </div>
          <div class="pillar-card">
            <div class="title">æ—¶æŸ±</div>
            <div class="ganZhi" id="hourPillar">--</div>
            <div class="details" id="hourDetails">--</div>
          </div>
        </div>

        <!-- è¯¦ç»†è¡¨æ ¼ -->
        <table class="bazi-table">
          <thead>
            <tr>
              <th>æŸ±ä½</th>
              <th>å¹²æ”¯</th>
              <th>åç¥</th>
              <th>äº”è¡Œ</th>
              <th>é˜´é˜³</th>
              <th>çº³éŸ³</th>
            </tr>
          </thead>
          <tbody id="baziTableBody"></tbody>
        </table>

        <!-- è¯¦ç»†ä¿¡æ¯é¢æ¿ -->
        <div class="info-panel" id="detailsPanel" style="display: none">
          <h3>è®¡ç®—è¯¦æƒ…</h3>
          <div id="calculationDetails"></div>
        </div>

        <!-- è­¦å‘Šæç¤º -->
        <div id="alertContainer"></div>
      </div>
    </div>

    <script>
      // ================== å¸¸é‡å®šä¹‰ ==================
      const STEMS = [
        "ç”²",
        "ä¹™",
        "ä¸™",
        "ä¸",
        "æˆŠ",
        "å·±",
        "åºš",
        "è¾›",
        "å£¬",
        "ç™¸",
      ];
      const BRANCHES = [
        "å­",
        "ä¸‘",
        "å¯…",
        "å¯",
        "è¾°",
        "å·³",
        "åˆ",
        "æœª",
        "ç”³",
        "é…‰",
        "æˆŒ",
        "äº¥",
      ];
      const STEM_ELEMENTS = [
        "æœ¨",
        "æœ¨",
        "ç«",
        "ç«",
        "åœŸ",
        "åœŸ",
        "é‡‘",
        "é‡‘",
        "æ°´",
        "æ°´",
      ];
      const STEM_YINYANG = [
        "é˜³",
        "é˜´",
        "é˜³",
        "é˜´",
        "é˜³",
        "é˜´",
        "é˜³",
        "é˜´",
        "é˜³",
        "é˜´",
      ];
      const BRANCH_ELEMENTS = [
        "æ°´",
        "åœŸ",
        "æœ¨",
        "æœ¨",
        "åœŸ",
        "ç«",
        "ç«",
        "åœŸ",
        "é‡‘",
        "é‡‘",
        "åœŸ",
        "æ°´",
      ];
      const NAYIN_60 = [
        "æµ·ä¸­é‡‘",
        "æµ·ä¸­é‡‘",
        "ç‚‰ä¸­ç«",
        "ç‚‰ä¸­ç«",
        "å¤§æ—æœ¨",
        "å¤§æ—æœ¨",
        "è·¯æ—åœŸ",
        "è·¯æ—åœŸ",
        "å‰‘é”‹é‡‘",
        "å‰‘é”‹é‡‘",
        "å±±å¤´ç«",
        "å±±å¤´ç«",
        "æ¶§ä¸‹æ°´",
        "æ¶§ä¸‹æ°´",
        "åŸå¤´åœŸ",
        "åŸå¤´åœŸ",
        "ç™½è…Šé‡‘",
        "ç™½è…Šé‡‘",
        "æ¨æŸ³æœ¨",
        "æ¨æŸ³æœ¨",
        "äº•æ³‰æ°´",
        "äº•æ³‰æ°´",
        "å±‹ä¸ŠåœŸ",
        "å±‹ä¸ŠåœŸ",
        "éœ¹é›³ç«",
        "éœ¹é›³ç«",
        "æ¾æŸæœ¨",
        "æ¾æŸæœ¨",
        "é•¿æµæ°´",
        "é•¿æµæ°´",
        "æ²™ä¸­é‡‘",
        "æ²™ä¸­é‡‘",
        "å±±ä¸‹ç«",
        "å±±ä¸‹ç«",
        "å¹³åœ°æœ¨",
        "å¹³åœ°æœ¨",
        "å£ä¸ŠåœŸ",
        "å£ä¸ŠåœŸ",
        "é‡‘ç®”é‡‘",
        "é‡‘ç®”é‡‘",
        "è¦†ç¯ç«",
        "è¦†ç¯ç«",
        "å¤©æ²³æ°´",
        "å¤©æ²³æ°´",
        "å¤§é©¿åœŸ",
        "å¤§é©¿åœŸ",
        "é’—é’é‡‘",
        "é’—é’é‡‘",
        "æ¡‘æŸ˜æœ¨",
        "æ¡‘æŸ˜æœ¨",
        "å¤§æºªæ°´",
        "å¤§æºªæ°´",
        "æ²™ä¸­åœŸ",
        "æ²™ä¸­åœŸ",
        "å¤©ä¸Šç«",
        "å¤©ä¸Šç«",
        "çŸ³æ¦´æœ¨",
        "çŸ³æ¦´æœ¨",
        "å¤§æµ·æ°´",
        "å¤§æµ·æ°´",
      ];

      // æ—¥æŸ±åç§»å¸¸æ•° - ä¿®æ­£ä¸ºç¡®ä¿å‡†ç¡®æ€§
      const DAY_OFFSET = 15; // è°ƒæ•´åç§»é‡ä»¥åŒ¹é…æ ‡å‡†æ—¥æŸ±

      // ================== å·¥å…·å‡½æ•° ==================

      // è§£ææ—¶åŒºå­—ç¬¦ä¸²
      function parseTimezone(tzStr) {
        const match = tzStr.match(/^([+-])(\d{2}):(\d{2})$/);
        if (!match) return 0;
        const sign = match[1] === "-" ? -1 : 1;
        return sign * (parseInt(match[2]) + parseInt(match[3]) / 60);
      }

      // è®¡ç®—å„’ç•¥æ—¥
      function toJulianDay(year, month, day, hour) {
        let y = year,
          m = month;
        if (m <= 2) {
          y -= 1;
          m += 12;
        }
        const A = Math.floor(y / 100);
        const B = 2 - A + Math.floor(A / 4);
        const JD =
          Math.floor(365.25 * (y + 4716)) +
          Math.floor(30.6001 * (m + 1)) +
          day +
          B -
          1524.5;
        return JD + hour / 24;
      }

      // è®¡ç®—å¤ªé˜³é»„ç»
      function solarLongitude(jd) {
        const T = (jd - 2451545.0) / 36525;
        const L0 = (280.46646 + 36000.76983 * T + 0.0003032 * T * T) % 360;
        const M =
          ((357.52911 + 35999.05029 * T - 0.0001537 * T * T) * Math.PI) / 180;
        const C =
          (1.914602 - 0.004817 * T - 0.000014 * T * T) * Math.sin(M) +
          (0.019993 - 0.000101 * T) * Math.sin(2 * M) +
          0.000289 * Math.sin(3 * M);
        let L = L0 + C;
        return ((L % 360) + 360) % 360;
      }

      // è§’åº¦å·®è®¡ç®—
      function angleDiff(target, current) {
        return ((target - current + 540) % 360) - 180;
      }

      // å¯»æ‰¾ç‰¹å®šå¤ªé˜³é»„ç»çš„æ—¶é—´ç‚¹
      function findSolarLongitudeTime(year, targetDegree, initialGuess) {
        let jd = toJulianDay(year, 2, 4, 12); // åˆå§‹çŒœæµ‹
        for (let i = 0; i < 15; i++) {
          const currentLongitude = solarLongitude(jd);
          const diff = angleDiff(targetDegree, currentLongitude);
          if (Math.abs(diff) < 1e-6) break;
          jd += diff / 0.98564736; // å¤ªé˜³æ¯æ—¥ç§»åŠ¨çº¦0.986åº¦
        }
        return jd;
      }

      // è·å–ç«‹æ˜¥æ—¶é—´ç‚¹
      function getLiChunTime(year) {
        return findSolarLongitudeTime(year, 315, null);
      }

      // å¹²æ”¯ç´¢å¼•è½¬æ¢ä¸ºå¹²æ”¯å­—ç¬¦ä¸²
      function indexToGanZhi(index) {
        return STEMS[index % 10] + BRANCHES[index % 12];
      }

      // å¹²æ”¯å­—ç¬¦ä¸²è½¬æ¢ä¸ºç´¢å¼•
      function ganZhiToIndex(ganZhi) {
        const gan = ganZhi[0];
        const zhi = ganZhi[1];
        const ganIndex = STEMS.indexOf(gan);
        const zhiIndex = BRANCHES.indexOf(zhi);

        // åœ¨60ç”²å­ä¸­æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•
        for (let i = 0; i < 60; i++) {
          if (i % 10 === ganIndex && i % 12 === zhiIndex) {
            return i;
          }
        }
        return -1;
      }

      // è®¡ç®—å¹´æŸ±
      function calculateYearPillar(jd, year) {
        const liChunJD = getLiChunTime(year);
        const actualYear = jd >= liChunJD ? year : year - 1;
        const yearIndex = (actualYear - 1984 + 60) % 60; // 1984å¹´ä¸ºç”²å­å¹´
        return {
          pillar: indexToGanZhi(yearIndex),
          actualYear: actualYear,
          liChunJD: liChunJD,
          isNearLiChun: Math.abs(jd - liChunJD) < 1,
        };
      }

      // è®¡ç®—æœˆæŸ±
      function calculateMonthPillar(yearStemIndex, solarLong) {
        // ä»¥ç«‹æ˜¥ä¸ºèµ·ç‚¹çš„èŠ‚æ°”æœˆ
        const monthIndex = Math.floor(((solarLong - 315 + 360) % 360) / 30);
        const branchIndex = (2 + monthIndex) % 12; // ä»å¯…æœˆå¼€å§‹

        // æœˆå¹²è®¡ç®—ï¼šå¯…æœˆèµ·å¹²å…¬å¼
        const startStem = ((yearStemIndex % 5) * 2 + 2) % 10;
        const stemIndex = (startStem + monthIndex) % 10;

        return {
          pillar: STEMS[stemIndex] + BRANCHES[branchIndex],
          monthIndex: monthIndex,
          branchIndex: branchIndex,
          stemIndex: stemIndex,
        };
      }

      // è®¡ç®—æ—¥æŸ± - ä½¿ç”¨æ ‡å‡†ä¸‡å¹´å†ç®—æ³•
      function calculateDayPillar(
        jdUTC,
        tzHours,
        useZi23,
        useSolarBoundary,
        solarCorr,
      ) {
        let jdLocal = jdUTC + tzHours / 24;

        if (useSolarBoundary) {
          jdLocal += solarCorr / 24;
        }

        const localHour = (jdLocal + 0.5 - Math.floor(jdLocal + 0.5)) * 24;

        if (useZi23 && localHour >= 23) {
          jdLocal += 1 / 24;
        }

        const JDN = Math.floor(jdLocal + 0.5);

        // æ ‡å‡†ä¸‡å¹´å†æ—¥æŸ±ç®—æ³•
        // å‚è€ƒç‚¹ï¼šä½¿ç”¨1985å¹´4æœˆ7æ—¥ä¸ºä¸™å­æ—¥ç›´æ¥æ ¡å‡†
        const testJD = toJulianDay(1985, 4, 7, 12); // 1985å¹´4æœˆ7æ—¥çš„å„’ç•¥æ—¥
        const testGanZhiIndex = ganZhiToIndex("ä¸™å­"); // ä¸™å­æ—¥çš„å¹²æ”¯ç´¢å¼•

        // è®¡ç®—å¤©æ•°å·®
        const daysDiff = Math.floor(JDN - Math.floor(testJD + 0.5));

        // è®¡ç®—å¹²æ”¯ç´¢å¼•
        let dayIndex = (testGanZhiIndex + daysDiff) % 60;
        if (dayIndex < 0) dayIndex += 60;

        return {
          pillar: indexToGanZhi(dayIndex),
          dayIndex: dayIndex,
          JDN: JDN,
          localHour: localHour,
          referenceJD: testJD,
          daysDiff: daysDiff,
        };
      }

      // è®¡ç®—æ—¶æŸ±
      function calculateHourPillar(
        jdUTC,
        tzHours,
        dayStemIndex,
        useSolarTime,
        longitude,
      ) {
        let jdLocal = jdUTC + tzHours / 24;
        let hour = (jdLocal + 0.5 - Math.floor(jdLocal + 0.5)) * 24;

        let solarCorr = 0;
        if (useSolarTime) {
          // ç»åº¦ä¿®æ­£
          const lonCorr = ((longitude - 15 * tzHours) * 4) / 60;

          // å‡æ—¶å·®ä¿®æ­£
          const T = (jdUTC - 2451545.0) / 36525;
          const L0 =
            ((280.46646 + 36000.76983 * T + 0.0003032 * T * T) * Math.PI) / 180;
          const M =
            ((357.52911 + 35999.05029 * T - 0.0001537 * T * T) * Math.PI) / 180;
          const e = 0.016708634 - 0.000042037 * T - 0.0000001267 * T * T;
          const E = 2 * e * Math.sin(M) + 1.25 * e * e * Math.sin(2 * M);
          const eot = ((Math.sin(2 * L0) - E) * 4) / 60;

          solarCorr = lonCorr + eot;
          hour = (hour + solarCorr + 24) % 24;
        }

        // æ—¶è¾°è®¡ç®—
        const branchIndex = Math.floor((hour + 1) / 2) % 12;
        const startStem = [0, 2, 4, 6, 8][dayStemIndex % 5];
        const stemIndex = (startStem + branchIndex) % 10;

        return {
          pillar: STEMS[stemIndex] + BRANCHES[branchIndex],
          hour: hour,
          solarCorr: solarCorr,
          branchIndex: branchIndex,
          stemIndex: stemIndex,
        };
      }

      // è®¡ç®—åç¥
      function calculateTenGod(dayStemIndex, targetStemIndex) {
        const elements = ["æœ¨", "ç«", "åœŸ", "é‡‘", "æ°´"];
        const restraint = { æœ¨: "åœŸ", åœŸ: "æ°´", æ°´: "ç«", ç«: "é‡‘", é‡‘: "æœ¨" };

        const dayElement = STEM_ELEMENTS[dayStemIndex];
        const targetElement = STEM_ELEMENTS[targetStemIndex];
        const sameYinYang =
          STEM_YINYANG[dayStemIndex] === STEM_YINYANG[targetStemIndex];

        if (dayElement === targetElement) {
          return sameYinYang ? "æ¯”è‚©" : "åŠ«è´¢";
        }

        const dayIdx = elements.indexOf(dayElement);
        const targetIdx = elements.indexOf(targetElement);

        if ((targetIdx + 1) % 5 === dayIdx) {
          return sameYinYang ? "æ­£å°" : "åå°";
        }
        if ((dayIdx + 1) % 5 === targetIdx) {
          return sameYinYang ? "é£Ÿç¥" : "ä¼¤å®˜";
        }
        if (restraint[dayElement] === targetElement) {
          return sameYinYang ? "æ­£è´¢" : "åè´¢";
        }
        if (restraint[targetElement] === dayElement) {
          return sameYinYang ? "ä¸ƒæ€" : "æ­£å®˜";
        }
        return "æœªçŸ¥";
      }

      // ================== ä¸»è®¡ç®—å‡½æ•° ==================
      function calculateBazi() {
        try {
          // è·å–è¾“å…¥å€¼
          const year = parseInt(document.getElementById("year").value);
          const month = parseInt(document.getElementById("month").value);
          const day = parseInt(document.getElementById("day").value);
          const hour = parseInt(document.getElementById("hour").value);
          const minute = parseInt(document.getElementById("minute").value);
          const second = parseInt(document.getElementById("second").value);
          const timezone = document.getElementById("timezone").value;
          const longitude = parseFloat(
            document.getElementById("longitude").value,
          );
          const latitude = parseFloat(
            document.getElementById("latitude").value,
          );
          const useSolarTime = document.getElementById("useSolarTime").checked;
          const useZi23 = document.getElementById("useZi23").checked;
          const useSolarBoundary =
            document.getElementById("useSolarBoundary").checked;
          const showDetails = document.getElementById("showDetails").checked;

          // è®¡ç®—UTCæ—¶é—´
          const tzHours = parseTimezone(timezone);
          const hourUTC = hour + minute / 60 + second / 3600 - tzHours;
          const jdUTC = toJulianDay(year, month, day, hourUTC);

          // è®¡ç®—å¤ªé˜³é»„ç»
          const solarLong = solarLongitude(jdUTC);

          // è®¡ç®—å¤ªé˜³æ—¶ä¿®æ­£
          let solarCorr = 0;
          if (useSolarTime || useSolarBoundary) {
            const lonCorr = ((longitude - 15 * tzHours) * 4) / 60;
            const T = (jdUTC - 2451545.0) / 36525;
            const L0 =
              ((280.46646 + 36000.76983 * T + 0.0003032 * T * T) * Math.PI) /
              180;
            const M =
              ((357.52911 + 35999.05029 * T - 0.0001537 * T * T) * Math.PI) /
              180;
            const e = 0.016708634 - 0.000042037 * T - 0.0000001267 * T * T;
            const E = 2 * e * Math.sin(M) + 1.25 * e * e * Math.sin(2 * M);
            const eot = ((Math.sin(2 * L0) - E) * 4) / 60;
            solarCorr = lonCorr + eot;
          }

          // è®¡ç®—å››æŸ±
          const yearResult = calculateYearPillar(jdUTC, year);
          const yearStemIndex = STEMS.indexOf(yearResult.pillar[0]);

          const monthResult = calculateMonthPillar(yearStemIndex, solarLong);
          const monthStemIndex = STEMS.indexOf(monthResult.pillar[0]);

          const dayResult = calculateDayPillar(
            jdUTC,
            tzHours,
            useZi23,
            useSolarBoundary,
            solarCorr,
          );
          const dayStemIndex = STEMS.indexOf(dayResult.pillar[0]);

          const hourResult = calculateHourPillar(
            jdUTC,
            tzHours,
            dayStemIndex,
            useSolarTime,
            longitude,
          );
          const hourStemIndex = STEMS.indexOf(hourResult.pillar[0]);

          // è®¡ç®—åç¥
          const yearGod = calculateTenGod(dayStemIndex, yearStemIndex);
          const monthGod = calculateTenGod(dayStemIndex, monthStemIndex);
          const hourGod = calculateTenGod(dayStemIndex, hourStemIndex);

          // æ˜¾ç¤ºç»“æœ
          displayResults({
            year: yearResult,
            month: monthResult,
            day: dayResult,
            hour: hourResult,
            gods: { year: yearGod, month: monthGod, hour: hourGod },
            stemIndices: {
              year: yearStemIndex,
              month: monthStemIndex,
              day: dayStemIndex,
              hour: hourStemIndex,
            },
            calculation: {
              jdUTC: jdUTC,
              solarLong: solarLong,
              tzHours: tzHours,
              solarCorr: solarCorr,
              showDetails: showDetails,
            },
          });

          // æ˜¾ç¤ºç»“æœåŒºåŸŸ
          document
            .getElementById("resultSection")
            .classList.add("show", "fade-in");
        } catch (error) {
          showAlert("è®¡ç®—å‡ºé”™ï¼š" + error.message, "warning");
          console.error("è®¡ç®—é”™è¯¯:", error);
        }
      }

      // æ˜¾ç¤ºç»“æœ
      function displayResults(result) {
        // æ›´æ–°å¡ç‰‡æ˜¾ç¤º
        document.getElementById("yearPillar").textContent = result.year.pillar;
        document.getElementById("monthPillar").textContent =
          result.month.pillar;
        document.getElementById("dayPillar").textContent = result.day.pillar;
        document.getElementById("hourPillar").textContent = result.hour.pillar;

        document.getElementById("yearDetails").innerHTML =
          `${result.gods.year}<br>${STEM_ELEMENTS[result.stemIndices.year]}${STEM_YINYANG[result.stemIndices.year]}`;
        document.getElementById("monthDetails").innerHTML =
          `${result.gods.month}<br>${STEM_ELEMENTS[result.stemIndices.month]}${STEM_YINYANG[result.stemIndices.month]}`;
        document.getElementById("dayDetails").innerHTML =
          `æ—¥ä¸»<br>${STEM_ELEMENTS[result.stemIndices.day]}${STEM_YINYANG[result.stemIndices.day]}`;
        document.getElementById("hourDetails").innerHTML =
          `${result.gods.hour}<br>${STEM_ELEMENTS[result.stemIndices.hour]}${STEM_YINYANG[result.stemIndices.hour]}`;

        // æ›´æ–°è¡¨æ ¼
        const tableBody = document.getElementById("baziTableBody");
        const pillars = [
          {
            name: "å¹´æŸ±",
            pillar: result.year.pillar,
            god: result.gods.year,
            stemIdx: result.stemIndices.year,
          },
          {
            name: "æœˆæŸ±",
            pillar: result.month.pillar,
            god: result.gods.month,
            stemIdx: result.stemIndices.month,
          },
          {
            name: "æ—¥æŸ±",
            pillar: result.day.pillar,
            god: "æ—¥ä¸»",
            stemIdx: result.stemIndices.day,
          },
          {
            name: "æ—¶æŸ±",
            pillar: result.hour.pillar,
            god: result.gods.hour,
            stemIdx: result.stemIndices.hour,
          },
        ];

        tableBody.innerHTML = "";
        pillars.forEach((p) => {
          const stemIdx = STEMS.indexOf(p.pillar[0]);
          const branchIdx = BRANCHES.indexOf(p.pillar[1]);
          // æ­£ç¡®çš„å…­åç”²å­ç´¢å¼•è®¡ç®—
          let pillarIndex = -1;
          for (let i = 0; i < 60; i++) {
            if (i % 10 === stemIdx && i % 12 === branchIdx) {
              pillarIndex = i;
              break;
            }
          }
          const nayin = NAYIN_60[pillarIndex];

          const row = tableBody.insertRow();
          row.innerHTML = `
                  <td><strong>${p.name}</strong></td>
                  <td><strong style="font-size: 1.2em; color: var(--primary-color);">${p.pillar}</strong></td>
                  <td>${p.god}</td>
                  <td>${STEM_ELEMENTS[p.stemIdx]}</td>
                  <td>${STEM_YINYANG[p.stemIdx]}</td>
                  <td>${nayin}</td>
              `;
        });

        // æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
        if (result.calculation.showDetails) {
          const detailsPanel = document.getElementById("detailsPanel");
          const detailsDiv = document.getElementById("calculationDetails");

          detailsDiv.innerHTML = `
                  <div class="info-row">
                      <span class="info-label">å„’ç•¥æ—¥(UTC)</span>
                      <span class="info-value">${result.calculation.jdUTC.toFixed(6)}</span>
                  </div>
                  <div class="info-row">
                      <span class="info-label">å¤ªé˜³é»„ç»</span>
                      <span class="info-value">${result.calculation.solarLong.toFixed(5)}Â°</span>
                  </div>
                  <div class="info-row">
                      <span class="info-label">æ—¶åŒºåç§»</span>
                      <span class="info-value">UTC${result.calculation.tzHours >= 0 ? "+" : ""}${result.calculation.tzHours.toFixed(2)}</span>
                  </div>
                  <div class="info-row">
                      <span class="info-label">å¤ªé˜³æ—¶ä¿®æ­£</span>
                      <span class="info-value">${result.calculation.solarCorr.toFixed(3)} å°æ—¶</span>
                  </div>
                  <div class="info-row">
                      <span class="info-label">ä½¿ç”¨å¹´ä»½</span>
                      <span class="info-value">${result.year.actualYear}å¹´ ${result.year.isNearLiChun ? "(ç«‹æ˜¥äº¤ç•Œ)" : ""}</span>
                  </div>
                  <div class="info-row">
                      <span class="info-label">æ—¥æŸ±JDN</span>
                      <span class="info-value">${result.day.JDN} (å‚è€ƒJD: ${result.day.referenceJD})</span>
                  </div>
                  <div class="info-row">
                      <span class="info-label">æ—¥æŸ±ç´¢å¼•</span>
                      <span class="info-value">${result.day.dayIndex}/60 (å¤©æ•°å·®: ${result.day.daysDiff})</span>
                  </div>
              `;

          detailsPanel.style.display = "block";
        } else {
          document.getElementById("detailsPanel").style.display = "none";
        }

        // æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
        const alertContainer = document.getElementById("alertContainer");
        alertContainer.innerHTML = "";

        if (result.year.isNearLiChun) {
          showAlert(
            "å½“å‰æ—¶é—´æ¥è¿‘ç«‹æ˜¥èŠ‚æ°”ç‚¹ï¼Œå¹´æŸ±å¯èƒ½å­˜åœ¨äº‰è®®ï¼Œè¯·æ³¨æ„æ ¸å®ã€‚",
            "warning",
          );
        }

        // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
        showAlert("å…«å­—æ’ç›˜è®¡ç®—å®Œæˆï¼", "success");
      }

      // ç²¾ç¾æç¤ºä¿¡æ¯
      function showAlert(message, type = "info") {
        const alertContainer = document.getElementById("alertContainer");
        const alert = document.createElement("div");
        alert.className = `alert alert-${type}`;

        // æ·»åŠ å›¾æ ‡
        let icon = "ğŸ“";
        if (type === "success") icon = "âœ¨";
        if (type === "warning") icon = "âš ï¸";
        if (type === "info") icon = "ğŸ’¡";

        alert.innerHTML = `${icon} ${message}`;
        alert.style.transform = "translateX(100%)";
        alert.style.transition = "var(--transition)";

        alertContainer.appendChild(alert);

        // æ»‘å…¥åŠ¨ç”»
        setTimeout(() => {
          alert.style.transform = "translateX(0)";
        }, 100);

        // 6ç§’åæ»‘å‡ºå¹¶ç§»é™¤
        setTimeout(() => {
          alert.style.transform = "translateX(100%)";
          setTimeout(() => {
            alert.remove();
          }, 300);
        }, 6000);
      }

      // é‡ç½®è¡¨å•
      function resetForm() {
        const now = new Date();
        document.getElementById("year").value = now.getFullYear();
        document.getElementById("month").value = now.getMonth() + 1;
        document.getElementById("day").value = now.getDate();
        document.getElementById("hour").value = now.getHours();
        document.getElementById("minute").value = now.getMinutes();
        document.getElementById("second").value = 0;
        document.getElementById("timezone").value = "+08:00";
        document.getElementById("longitude").value = "116.40";
        document.getElementById("latitude").value = "39.90";
        document.getElementById("useSolarTime").checked = false;
        document.getElementById("useZi23").checked = true;
        document.getElementById("useSolarBoundary").checked = false;
        document.getElementById("showDetails").checked = true;

        document.getElementById("resultSection").classList.remove("show");
        document.getElementById("alertContainer").innerHTML = "";
      }

      // æ·»åŠ éªŒè¯å‡½æ•°
      function validateDayPillar() {
        // æµ‹è¯•å·²çŸ¥çš„æ—¥æŸ±å¯¹ç…§è¡¨ï¼ˆæŒ‰ç…§ä¸‡å¹´å†æ ‡å‡†ï¼‰
        const testCases = [
          {
            year: 1985,
            month: 4,
            day: 7,
            hour: 10,
            expected: "ä¸™å­",
            desc: "1985å¹´4æœˆ7æ—¥ 10æ—¶ (å‚è€ƒç‚¹)",
          },
          {
            year: 1985,
            month: 4,
            day: 8,
            hour: 10,
            expected: "ä¸ä¸‘",
            desc: "1985å¹´4æœˆ8æ—¥ 10æ—¶",
          },
          {
            year: 1985,
            month: 4,
            day: 6,
            hour: 10,
            expected: "ä¹™äº¥",
            desc: "1985å¹´4æœˆ6æ—¥ 10æ—¶",
          },
          {
            year: 2024,
            month: 4,
            day: 7,
            hour: 12,
            expected: "ä¸™å­",
            desc: "2024å¹´4æœˆ7æ—¥ 12æ—¶",
          },
          {
            year: 1900,
            month: 1,
            day: 1,
            hour: 12,
            expected: "ç”²è¾°",
            desc: "1900å¹´1æœˆ1æ—¥ 12æ—¶",
          },
        ];

        console.log("=== æ—¥æŸ±ç®—æ³•éªŒè¯ (ä¸‡å¹´å†æ ‡å‡†) ===");
        let correctCount = 0;
        testCases.forEach((testCase) => {
          const jdUTC = toJulianDay(
            testCase.year,
            testCase.month,
            testCase.day,
            testCase.hour,
          );
          const result = calculateDayPillar(jdUTC, 8, true, false, 0);
          const match = result.pillar === testCase.expected;
          if (match) correctCount++;
          const expectedIndex = ganZhiToIndex(testCase.expected);
          console.log(
            `${testCase.desc}: è®¡ç®—=${result.pillar}(${result.dayIndex}), é¢„æœŸ=${testCase.expected}(${expectedIndex}), JD=${jdUTC.toFixed(2)}, å¤©æ•°å·®=${result.daysDiff}, ${match ? "âœ“æ­£ç¡®" : "âœ—é”™è¯¯"}`,
          );
        });
        console.log(`éªŒè¯ç»“æœ: ${correctCount}/${testCases.length} æ­£ç¡®`);

        // ç‰¹åˆ«éªŒè¯æ—¶æŸ±
        console.log("\n=== æ—¶æŸ±éªŒè¯ ===");
        const hourTest = testCases[0]; // 1985å¹´4æœˆ7æ—¥ 10æ—¶
        const jdUTC = toJulianDay(
          hourTest.year,
          hourTest.month,
          hourTest.day,
          hourTest.hour - 8,
        ); // UTCæ—¶é—´
        const dayResult = calculateDayPillar(jdUTC, 8, true, false, 0);
        const dayStemIndex = STEMS.indexOf(dayResult.pillar[0]);
        const hourResult = calculateHourPillar(
          jdUTC,
          8,
          dayStemIndex,
          false,
          116.4,
        );
        console.log(
          `${hourTest.desc} æ—¶æŸ±: è®¡ç®—=${hourResult.pillar}, é¢„æœŸ=ç™¸å·³, ${hourResult.pillar === "ç™¸å·³" ? "âœ“æ­£ç¡®" : "âœ—é”™è¯¯"}`,
        );

        // æ˜¾ç¤º60ç”²å­è¡¨ä¾›å‚è€ƒ
        console.log("\n=== 60ç”²å­è¡¨ ===");
        for (let i = 0; i < 60; i += 10) {
          const row = [];
          for (let j = 0; j < 10 && i + j < 60; j++) {
            const idx = i + j;
            row.push(`${idx.toString().padStart(2)}: ${indexToGanZhi(idx)}`);
          }
          console.log(row.join(" | "));
        }

        return correctCount === testCases.length;
      }

      // äº‹ä»¶ç›‘å¬å™¨
      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("calculateBtn")
          .addEventListener("click", calculateBtn);
        document
          .getElementById("resetBtn")
          .addEventListener("click", resetForm);

        // è®¾ç½®æµ‹è¯•æ—¶é—´ä¸ºé»˜è®¤å€¼ (éªŒè¯1985å¹´4æœˆ7æ—¥ä¸ºä¸™å­æ—¥ç™¸å·³æ—¶)
        document.getElementById("year").value = 1985;
        document.getElementById("month").value = 4;
        document.getElementById("day").value = 7;
        document.getElementById("hour").value = 10;
        document.getElementById("minute").value = 0;

        // éªŒè¯ç®—æ³•å¹¶è‡ªåŠ¨è®¡ç®—
        const isValid = validateDayPillar();
        if (isValid) {
          console.log("ğŸ‰ æ—¥æŸ±ç®—æ³•éªŒè¯é€šè¿‡ï¼");
        } else {
          console.warn("âš ï¸ æ—¥æŸ±ç®—æ³•éªŒè¯å¤±è´¥ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒæ•´");
        }

        // æ·»åŠ é¡µé¢åŠ è½½åŠ¨ç”»
        document.body.style.opacity = "0";
        document.body.style.transform = "translateY(20px)";
        setTimeout(() => {
          document.body.style.transition = "var(--transition)";
          document.body.style.opacity = "1";
          document.body.style.transform = "translateY(0)";
        }, 100);

        setTimeout(() => {
          calculateBazi();
          document
            .getElementById("resultSection")
            .classList.add("show", "fade-in");
          // æ·»åŠ ç²¾ç¾çš„æˆåŠŸæç¤ºå’ŒåŠ¨ç”»æ•ˆæœ
          showAlert("ğŸ‰ ç®—æ³•éªŒè¯å®Œæˆï¼ä¸‡å¹´å†æ¨¡å¼å·²å¯ç”¨", "success");
          // æ·»åŠ å¡ç‰‡åŠ¨ç”»ï¼ˆç§»åŠ¨è®¾å¤‡ä¼˜åŒ–ï¼‰
          const cards = document.querySelectorAll(".pillar-card");
          const isMobile = window.innerWidth <= 768;
          cards.forEach((card, index) => {
            setTimeout(
              () => {
                card.style.animation = `scaleIn 0.6s ease-out ${index * (isMobile ? 0.05 : 0.1)}s both`;
              },
              isMobile ? 200 : 300,
            );
          });
        }, 1200);
      });

      // ç²¾ç¾è®¡ç®—æŒ‰é’®å¤„ç†
      function calculateBtn() {
        const btn = document.getElementById("calculateBtn");
        const originalText = btn.innerHTML;

        // ç²¾ç¾åŠ è½½çŠ¶æ€
        btn.innerHTML = `
              <div class="spinner" style="width: 20px; height: 20px; border-width: 3px; margin-right: 10px;"></div>
              <span class="loading-text">æ­£åœ¨è®¡ç®—å…«å­—...</span>
          `;
        btn.disabled = true;
        btn.style.background = "var(--gradient-secondary)";

        // æ·»åŠ æŒ‰é’®åŠ¨ç”»
        btn.style.transform = "scale(0.95)";
        setTimeout(() => {
          btn.style.transform = "scale(1)";
        }, 100);

        // æ¨¡æ‹Ÿè®¡ç®—å»¶è¿Ÿï¼Œæå‡ç”¨æˆ·ä½“éªŒ
        setTimeout(() => {
          calculateBazi();
          btn.innerHTML = originalText + " âœ“";
          btn.style.background = "var(--gradient-primary)";
          btn.disabled = false;

          // æˆåŠŸåŠ¨ç”»
          btn.style.animation = "pulse 0.6s ease-out";
          setTimeout(() => {
            btn.style.animation = "";
            btn.innerHTML = originalText;
          }, 600);
        }, 800);
      }
    </script>
  </body>
</html>
